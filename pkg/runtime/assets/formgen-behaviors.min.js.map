{
  "version": 3,
  "sources": ["../../src/behaviors/index.ts", "../../src/behaviors/utils.ts", "../../src/behaviors/auto-slug.ts", "../../src/behaviors/auto-resize.ts", "../../src/behaviors/registry.ts", "../../src/icons/registry.ts", "../../src/editors/json-gui.ts"],
  "sourcesContent": ["import { autoSlug } from \"./auto-slug\";\nimport { autoResize } from \"./auto-resize\";\nimport { initBehaviors as initBehaviorsCore, registerBehavior, resetBehaviorRegistry } from \"./registry\";\nimport type { BehaviorInitResult } from \"./registry\";\nimport { slugify } from \"./utils\";\nimport { initIcons, registerIconProvider, __resetIconProvidersForTests } from \"../icons\";\nimport { initJSONEditors } from \"../editors\";\n\nregisterDefaults();\n\nfunction registerDefaults(): void {\n  registerBehavior(\"autoSlug\", autoSlug);\n  registerBehavior(\"autoResize\", autoResize);\n}\n\nexport function initBehaviors(root: Document | HTMLElement = document): BehaviorInitResult {\n  const result = initBehaviorsCore(root);\n  initIcons(root);\n  initJSONEditors();\n  return result;\n}\n\nexport { registerBehavior, registerIconProvider, initIcons, initJSONEditors, slugify, autoSlug, autoResize };\nexport type { BehaviorContext, BehaviorFactory } from \"./types\";\nexport type { BehaviorInitResult } from \"./registry\";\n\nexport function __resetBehaviorsForTests(): void {\n  resetBehaviorRegistry();\n  __resetIconProvidersForTests();\n  registerDefaults();\n}\n", "export function slugify(input: string): string {\n  if (!input) {\n    return \"\";\n  }\n  return input\n    .normalize(\"NFKD\")\n    .replace(/[\\u0300-\\u036f]/g, \"\")\n    .replace(/[^a-zA-Z0-9\\s-]/g, \" \")\n    .trim()\n    .replace(/[\\s_-]+/g, \"-\")\n    .replace(/^-+|-+$/g, \"\")\n    .toLowerCase();\n}\n\nexport function normalizeBehaviorName(name: string): string {\n  return name?.trim().toLowerCase() ?? \"\";\n}\n\nexport function collectBehaviorElements(root: Document | HTMLElement): HTMLElement[] {\n  const scope = root instanceof Document ? root : root;\n  const elements = Array.from(scope.querySelectorAll<HTMLElement>(\"[data-behavior]\"));\n  if (root instanceof HTMLElement && root.hasAttribute(\"data-behavior\")) {\n    elements.unshift(root);\n  }\n  return elements;\n}\n\nexport function parseBehaviorNames(raw: string | null): string[] {\n  if (!raw) {\n    return [];\n  }\n  const tokens = raw\n    .split(/[\\s,]+/)\n    .map((token) => normalizeBehaviorName(token))\n    .filter(Boolean);\n  return Array.from(new Set(tokens));\n}\n\nexport function parseBehaviorConfig(raw: string | null): unknown {\n  if (!raw) {\n    return undefined;\n  }\n  try {\n    return JSON.parse(raw);\n  } catch (error) {\n    console.warn(\"[formgen:behaviors] failed to parse data-behavior-config:\", error);\n    return undefined;\n  }\n}\n\nexport function selectBehaviorConfig(parsed: unknown, name: string, total: number): unknown {\n  if (parsed && typeof parsed === \"object\" && parsed !== null) {\n    const record = parsed as Record<string, unknown>;\n    if (Object.prototype.hasOwnProperty.call(record, name)) {\n      return record[name];\n    }\n    if (total === 1) {\n      return parsed;\n    }\n    return undefined;\n  }\n  if (total === 1) {\n    return parsed;\n  }\n  return undefined;\n}\n\nexport function resolveRootElement(element: HTMLElement, scope: Document | HTMLElement): HTMLElement {\n  const nearest = element.closest<HTMLElement>(\"[data-formgen-auto-init]\");\n  if (nearest) {\n    return nearest;\n  }\n  if (scope instanceof HTMLElement) {\n    return scope;\n  }\n  return scope.body ?? element.ownerDocument?.body ?? element;\n}\n\nexport function isInputControl(\n  node: Element | null,\n): node is HTMLInputElement | HTMLTextAreaElement {\n  return (\n    !!node &&\n    (node instanceof HTMLInputElement || node instanceof HTMLTextAreaElement)\n  );\n}\n\nexport function findNearestInput(element: HTMLElement): HTMLInputElement | HTMLTextAreaElement | null {\n  if (isInputControl(element)) {\n    return element;\n  }\n  return element.querySelector<HTMLInputElement | HTMLTextAreaElement>(\"input, textarea\");\n}\n\nexport function findFieldInput(\n  root: HTMLElement,\n  key: string,\n): HTMLInputElement | HTMLTextAreaElement | null {\n  if (!key) {\n    return null;\n  }\n  const attrSelector = `[name=\"${key}\"]`;\n  const idSelector = `#${buildElementID(key)}`;\n  return (\n    root.querySelector<HTMLInputElement | HTMLTextAreaElement>(attrSelector) ??\n    root.querySelector<HTMLInputElement | HTMLTextAreaElement>(idSelector)\n  );\n}\n\nexport function buildElementID(key: string): string {\n  const escaped = key.replace(/[^a-zA-Z0-9_-]/g, \"-\");\n  return escaped.startsWith(\"fg-\") ? escaped : `fg-${escaped}`;\n}\n", "import type { BehaviorFactory } from \"./types\";\nimport { findFieldInput, findNearestInput, slugify } from \"./utils\";\n\ninterface AutoSlugConfig {\n  source?: string;\n}\n\nexport const autoSlug: BehaviorFactory = ({ element, config, root }) => {\n  const target = findNearestInput(element);\n  if (!target) {\n    console.warn(\"[formgen:behaviors] autoSlug requires an input or textarea target.\");\n    return;\n  }\n\n  const options = normaliseConfig(config);\n  if (!options.source) {\n    console.warn(\"[formgen:behaviors] autoSlug config must define a source field.\");\n    return;\n  }\n\n  const source = findFieldInput(root, options.source);\n  if (!source) {\n    console.warn(`[formgen:behaviors] source field \"${options.source}\" not found for autoSlug.`);\n    return;\n  }\n\n  let syncing = false;\n  let manual = element.getAttribute(\"data-behavior-state\") === \"manual\";\n\n  if (!manual && target.value.trim().length > 0) {\n    manual = true;\n    element.setAttribute(\"data-behavior-state\", \"manual\");\n  }\n\n  const updateSlug = () => {\n    if (manual) {\n      return;\n    }\n    const nextValue = slugify(source.value || \"\");\n    if (nextValue === target.value) {\n      return;\n    }\n    syncing = true;\n    target.value = nextValue;\n    target.dispatchEvent(new Event(\"input\", { bubbles: true }));\n    syncing = false;\n  };\n\n  const handleSourceInput = () => {\n    updateSlug();\n  };\n\n  const handleTargetInput = (event: Event) => {\n    if (syncing) {\n      return;\n    }\n    const trimmed = target.value.trim();\n    if (trimmed.length === 0) {\n      manual = false;\n      element.removeAttribute(\"data-behavior-state\");\n      updateSlug();\n      return;\n    }\n    manual = true;\n    element.setAttribute(\"data-behavior-state\", \"manual\");\n  };\n\n  source.addEventListener(\"input\", handleSourceInput);\n  target.addEventListener(\"input\", handleTargetInput);\n\n  updateSlug();\n\n  return () => {\n    source.removeEventListener(\"input\", handleSourceInput);\n    target.removeEventListener(\"input\", handleTargetInput);\n  };\n};\n\nfunction normaliseConfig(config: unknown): AutoSlugConfig {\n  if (typeof config === \"string\") {\n    return { source: config };\n  }\n  if (config && typeof config === \"object\") {\n    const record = config as Record<string, unknown>;\n    const source = typeof record.source === \"string\" ? record.source : undefined;\n    return { source };\n  }\n  return {};\n}\n", "import type { BehaviorFactory } from \"./types\";\nimport { findNearestInput } from \"./utils\";\n\ninterface AutoResizeConfig {\n  minRows?: number;\n  maxRows?: number;\n}\n\nexport const autoResize: BehaviorFactory = ({ element, config }) => {\n  const target = findNearestInput(element);\n  if (!(target instanceof HTMLTextAreaElement)) {\n    console.warn(\"[formgen:behaviors] autoResize requires a textarea target.\");\n    return;\n  }\n\n  const options = normaliseConfig(config);\n  const rowsConfig = normaliseBounds(options);\n\n  const resize = () => {\n    const computed = window.getComputedStyle(target);\n    const lineHeight = resolveLineHeightPx(computed);\n    if (!lineHeight) {\n      return;\n    }\n\n    const paddingTop = parseFloat(computed.paddingTop || \"0\") || 0;\n    const paddingBottom = parseFloat(computed.paddingBottom || \"0\") || 0;\n    const borderTop = parseFloat(computed.borderTopWidth || \"0\") || 0;\n    const borderBottom = parseFloat(computed.borderBottomWidth || \"0\") || 0;\n    const chrome = paddingTop + paddingBottom + borderTop + borderBottom;\n\n    target.style.height = \"auto\";\n\n    const minRows = rowsConfig.minRows ?? target.rows;\n    const maxRows = rowsConfig.maxRows;\n    const minHeight = minRows ? lineHeight * minRows + chrome : undefined;\n    const maxHeight = maxRows ? lineHeight * maxRows + chrome : undefined;\n\n    let nextHeight = target.scrollHeight;\n    if (minHeight !== undefined && nextHeight < minHeight) {\n      nextHeight = minHeight;\n    }\n    if (maxHeight !== undefined && nextHeight > maxHeight) {\n      nextHeight = maxHeight;\n    }\n\n    target.style.height = `${Math.ceil(nextHeight)}px`;\n\n    if (rowsConfig.minRows !== undefined) {\n      target.rows = rowsConfig.minRows;\n    }\n  };\n\n  const handleInput = () => resize();\n\n  target.addEventListener(\"input\", handleInput);\n  resize();\n\n  return () => {\n    target.removeEventListener(\"input\", handleInput);\n  };\n};\n\nfunction normaliseConfig(config: unknown): AutoResizeConfig {\n  if (!config || typeof config !== \"object\") {\n    return {};\n  }\n  const record = config as Record<string, unknown>;\n  return {\n    minRows: coercePositiveInt(record.minRows),\n    maxRows: coercePositiveInt(record.maxRows),\n  };\n}\n\nfunction coercePositiveInt(value: unknown): number | undefined {\n  const parsed =\n    typeof value === \"number\"\n      ? value\n      : typeof value === \"string\"\n        ? Number.parseInt(value, 10)\n        : NaN;\n  if (!Number.isFinite(parsed)) {\n    return undefined;\n  }\n  const normalized = Math.floor(parsed);\n  if (normalized <= 0) {\n    return undefined;\n  }\n  return normalized;\n}\n\nfunction normaliseBounds(options: AutoResizeConfig): AutoResizeConfig {\n  const minRows = options.minRows;\n  const maxRows = options.maxRows;\n  if (minRows !== undefined && maxRows !== undefined && maxRows < minRows) {\n    return { minRows, maxRows: minRows };\n  }\n  return options;\n}\n\nfunction resolveLineHeightPx(computed: CSSStyleDeclaration): number | undefined {\n  const raw = computed.lineHeight;\n  if (raw && raw !== \"normal\") {\n    const parsed = Number.parseFloat(raw);\n    if (Number.isFinite(parsed) && parsed > 0) {\n      return parsed;\n    }\n  }\n\n  const fontSize = Number.parseFloat(computed.fontSize || \"\");\n  if (Number.isFinite(fontSize) && fontSize > 0) {\n    return fontSize * 1.2;\n  }\n\n  return undefined;\n}\n", "import type { BehaviorFactory, BehaviorTeardown } from \"./types\";\nimport {\n  collectBehaviorElements,\n  normalizeBehaviorName,\n  parseBehaviorConfig,\n  parseBehaviorNames,\n  resolveRootElement,\n  selectBehaviorConfig,\n} from \"./utils\";\n\ntype DisposeFn = (() => void) | undefined;\n\ninterface BehaviorRecord {\n  element: HTMLElement;\n  name: string;\n  dispose?: DisposeFn;\n}\n\nexport interface BehaviorInitResult {\n  dispose(): void;\n  records: BehaviorRecord[];\n}\n\nconst factories = new Map<string, BehaviorFactory>();\nlet instances = new WeakMap<HTMLElement, Map<string, DisposeFn>>();\n\nexport function registerBehavior(name: string, factory: BehaviorFactory): void {\n  const normalized = normalizeBehaviorName(name);\n  if (!normalized || typeof factory !== \"function\") {\n    return;\n  }\n  factories.set(normalized, factory);\n}\n\nexport function initBehaviors(root: Document | HTMLElement = document): BehaviorInitResult {\n  const elements = collectBehaviorElements(root);\n  const records: BehaviorRecord[] = [];\n\n  for (const element of elements) {\n    const names = parseBehaviorNames(element.getAttribute(\"data-behavior\"));\n    if (names.length === 0) {\n      continue;\n    }\n    const configPayload = parseBehaviorConfig(element.getAttribute(\"data-behavior-config\"));\n    const scopeRoot = resolveRootElement(element, root);\n\n    for (const rawName of names) {\n      const normalized = normalizeBehaviorName(rawName);\n      if (!normalized) {\n        continue;\n      }\n\n      if (hasActiveInstance(element, normalized)) {\n        continue;\n      }\n\n      const factory = factories.get(normalized);\n      if (!factory) {\n        console.warn(`[formgen:behaviors] behavior \"${normalized}\" is not registered.`);\n        continue;\n      }\n\n      const contextConfig = selectBehaviorConfig(configPayload, normalized, names.length);\n      const dispose = invokeFactory(factory, {\n        element,\n        name: normalized,\n        root: scopeRoot,\n        config: contextConfig,\n      });\n\n      setActiveInstance(element, normalized, dispose);\n      records.push({ element, name: normalized, dispose });\n    }\n  }\n\n  return {\n    records,\n    dispose: () => {\n      for (const record of records.splice(0)) {\n        if (record.dispose) {\n          try {\n            record.dispose();\n          } catch (error) {\n            console.warn(`[formgen:behaviors] dispose failed for ${record.name}:`, error);\n          }\n        }\n        clearActiveInstance(record.element, record.name);\n      }\n    },\n  };\n}\n\nexport function resetBehaviorRegistry(): void {\n  factories.clear();\n  instances = new WeakMap();\n}\n\nfunction invokeFactory(factory: BehaviorFactory, context: Parameters<BehaviorFactory>[0]): DisposeFn {\n  let teardown: BehaviorTeardown;\n  try {\n    teardown = factory(context);\n  } catch (error) {\n    console.warn(`[formgen:behaviors] factory for \"${context.name}\" failed:`, error);\n    return undefined;\n  }\n  if (typeof teardown === \"function\") {\n    return teardown;\n  }\n  if (teardown && typeof teardown === \"object\" && typeof teardown.dispose === \"function\") {\n    return () => teardown.dispose();\n  }\n  return undefined;\n}\n\nfunction getInstanceMap(element: HTMLElement): Map<string, DisposeFn> {\n  let map = instances.get(element);\n  if (!map) {\n    map = new Map();\n    instances.set(element, map);\n  }\n  return map;\n}\n\nfunction hasActiveInstance(element: HTMLElement, name: string): boolean {\n  const map = instances.get(element);\n  return map ? map.has(name) : false;\n}\n\nfunction setActiveInstance(element: HTMLElement, name: string, dispose: DisposeFn): void {\n  getInstanceMap(element).set(name, dispose);\n}\n\nfunction clearActiveInstance(element: HTMLElement, name: string): void {\n  const map = instances.get(element);\n  if (!map) {\n    return;\n  }\n  map.delete(name);\n  if (map.size === 0) {\n    instances.delete(element);\n  }\n}\n", "export type IconProvider = (name: string) => string | null | undefined;\n\nexport interface IconInitRecord {\n  element: HTMLElement;\n  name: string;\n  source: string;\n  rendered: boolean;\n}\n\nexport interface IconInitResult {\n  records: IconInitRecord[];\n}\n\nconst providers = new Map<string, IconProvider>();\n\nexport function registerIconProvider(source: string, provider: IconProvider): void {\n  const normalized = normalize(source);\n  if (!normalized || typeof provider !== \"function\") {\n    return;\n  }\n  providers.set(normalized, provider);\n}\n\nexport function initIcons(root: Document | HTMLElement = document): IconInitResult {\n  const elements = collectIconElements(root);\n  const records: IconInitRecord[] = [];\n\n  for (const element of elements) {\n    const name = normalize(element.getAttribute(\"data-icon\"));\n    const source = normalize(element.getAttribute(\"data-icon-source\"));\n\n    if (!name || !source) {\n      continue;\n    }\n\n    const hasRaw = normalize(element.getAttribute(\"data-icon-raw\")) !== \"\";\n    if (hasRaw) {\n      records.push({ element, name, source, rendered: false });\n      continue;\n    }\n\n    const provider = providers.get(source);\n    if (!provider) {\n      records.push({ element, name, source, rendered: false });\n      continue;\n    }\n\n    const svgMarkup = safeInvokeProvider(provider, name);\n    const svg = parseSvgMarkup(svgMarkup, element.ownerDocument ?? document);\n    if (!svg) {\n      records.push({ element, name, source, rendered: false });\n      continue;\n    }\n\n    const host = resolveIconHost(element);\n    if (!host) {\n      records.push({ element, name, source, rendered: false });\n      continue;\n    }\n\n    while (host.firstChild) {\n      host.removeChild(host.firstChild);\n    }\n\n    const wrapper = (element.ownerDocument ?? document).createElement(\"span\");\n    wrapper.className = \"inline-flex size-5 text-current\";\n    wrapper.setAttribute(\"aria-hidden\", \"true\");\n    wrapper.appendChild(svg);\n    host.appendChild(wrapper);\n\n    records.push({ element, name, source, rendered: true });\n  }\n\n  return { records };\n}\n\nexport function __resetIconProvidersForTests(): void {\n  providers.clear();\n}\n\nfunction collectIconElements(root: Document | HTMLElement): HTMLElement[] {\n  const scope = root instanceof Document ? root : root;\n  const elements = Array.from(\n    scope.querySelectorAll<HTMLElement>(\"[data-icon][data-icon-source]\"),\n  );\n  if (root instanceof HTMLElement && root.hasAttribute(\"data-icon\") && root.hasAttribute(\"data-icon-source\")) {\n    elements.unshift(root);\n  }\n  return Array.from(new Set(elements));\n}\n\nfunction resolveIconHost(element: HTMLElement): HTMLElement | null {\n  const parent = element.parentElement;\n  if (!parent) {\n    return null;\n  }\n\n  const previous = element.previousElementSibling;\n  if (previous instanceof HTMLElement && previous.tagName === \"SPAN\" && previous.getAttribute(\"aria-hidden\") === \"true\") {\n    return previous;\n  }\n\n  return parent.querySelector<HTMLElement>(`:scope > span[aria-hidden=\"true\"]`);\n}\n\nfunction safeInvokeProvider(provider: IconProvider, name: string): string {\n  try {\n    return provider(name) ?? \"\";\n  } catch (error) {\n    console.warn(`[formgen:icons] provider for \"${name}\" failed:`, error);\n    return \"\";\n  }\n}\n\nfunction parseSvgMarkup(markup: string, doc: Document): SVGSVGElement | null {\n  const trimmed = markup?.trim();\n  if (!trimmed) {\n    return null;\n  }\n\n  if (typeof DOMParser === \"undefined\") {\n    return null;\n  }\n\n  const parser = new DOMParser();\n  const parsed = parser.parseFromString(trimmed, \"image/svg+xml\");\n  const svg = parsed.querySelector(\"svg\");\n  if (!svg) {\n    return null;\n  }\n\n  sanitizeSvg(svg);\n\n  if (typeof doc.importNode === \"function\") {\n    return doc.importNode(svg, true) as SVGSVGElement;\n  }\n  return svg;\n}\n\nfunction sanitizeSvg(svg: SVGSVGElement): void {\n  svg.querySelectorAll(\"script, foreignObject, iframe, object, embed\").forEach((node) => {\n    node.parentNode?.removeChild(node);\n  });\n\n  const all = [svg as unknown as Element, ...Array.from(svg.querySelectorAll(\"*\"))];\n  for (const element of all) {\n    const attrs = Array.from(element.attributes);\n    for (const attr of attrs) {\n      const name = attr.name.toLowerCase();\n      const value = attr.value.trim().toLowerCase();\n\n      if (name.startsWith(\"on\")) {\n        element.removeAttribute(attr.name);\n        continue;\n      }\n\n      if (name === \"href\" || name === \"xlink:href\" || name === \"src\") {\n        const safe =\n          value === \"\" ||\n          value.startsWith(\"#\") ||\n          value.startsWith(\"data:image/\");\n        if (!safe || value.startsWith(\"javascript:\")) {\n          element.removeAttribute(attr.name);\n        }\n      }\n    }\n  }\n}\n\nfunction normalize(value: string | null | undefined): string {\n  return value?.trim().toLowerCase() ?? \"\";\n}\n\n", "/**\n * JSON GUI Editor\n *\n * Provides a visual key-value editor for JSON objects and arrays with support for:\n * - Primitive types: string, number, boolean, null\n * - Nested types: object, array (rendered inline recursively)\n * - Top-level arrays and objects\n * - Add, delete, reorder fields/items\n * - Mode toggle between GUI and raw textarea (hybrid mode)\n * - Readonly/disabled states\n * - Type coercion with validation\n */\n\n// ============================================================================\n// Types\n// ============================================================================\n\ntype JSONValue = string | number | boolean | null | JSONObject | JSONArray;\ntype JSONObject = { [key: string]: JSONValue };\ntype JSONArray = JSONValue[];\n\ntype JSONType = \"string\" | \"number\" | \"boolean\" | \"null\" | \"object\" | \"array\";\n\ninterface FieldRow {\n  id: string;\n  key: string;\n  value: JSONValue;\n  type: JSONType;\n  element: HTMLElement;\n  depth: number;\n  lastValidNumber?: number; // Track last valid number for validation\n  hasError?: boolean;\n  numberError?: string;\n}\n\ninterface EditorState {\n  root: HTMLElement;\n  textarea: HTMLTextAreaElement | null;\n  preview: HTMLPreElement | null;\n  guiContainer: HTMLElement | null;\n  rowsContainer: HTMLElement | null;\n  addButton: HTMLButtonElement | null;\n  rows: FieldRow[];\n  mode: \"raw\" | \"gui\" | \"hybrid\";\n  activeView: \"raw\" | \"gui\";\n  readonly: boolean;\n  disabled: boolean;\n  rootType: \"object\" | \"array\";\n  parseError: string | null;\n}\n\n// ============================================================================\n// Constants\n// ============================================================================\n\nconst ROOT_SELECTOR = '[data-json-editor=\"true\"]';\nconst INIT_ATTR = \"data-json-editor-init\";\n\nconst TYPE_OPTIONS: { value: JSONType; label: string }[] = [\n  { value: \"string\", label: \"String\" },\n  { value: \"number\", label: \"Number\" },\n  { value: \"boolean\", label: \"Boolean\" },\n  { value: \"null\", label: \"Null\" },\n  { value: \"object\", label: \"Object\" },\n  { value: \"array\", label: \"Array\" },\n];\n\n// ============================================================================\n// Utilities\n// ============================================================================\n\nlet rowIdCounter = 0;\nfunction generateRowId(): string {\n  return `json-row-${++rowIdCounter}`;\n}\n\nfunction parseJSON(value: string): JSONValue | undefined {\n  try {\n    return JSON.parse(value);\n  } catch {\n    return undefined;\n  }\n}\n\nfunction stringifyJSON(value: JSONValue): string {\n  return JSON.stringify(value, null, 2);\n}\n\nfunction detectType(value: JSONValue): JSONType {\n  if (value === null) return \"null\";\n  if (Array.isArray(value)) return \"array\";\n  if (typeof value === \"object\") return \"object\";\n  if (typeof value === \"number\") return \"number\";\n  if (typeof value === \"boolean\") return \"boolean\";\n  return \"string\";\n}\n\nfunction detectRootType(value: JSONValue): \"object\" | \"array\" {\n  return Array.isArray(value) ? \"array\" : \"object\";\n}\n\nfunction getDefaultValue(type: JSONType): JSONValue {\n  switch (type) {\n    case \"string\":\n      return \"\";\n    case \"number\":\n      return 0;\n    case \"boolean\":\n      return false;\n    case \"null\":\n      return null;\n    case \"object\":\n      return {};\n    case \"array\":\n      return [];\n  }\n}\n\n/**\n * Validates and parses a number string.\n * Returns { valid: true, value: number } if valid.\n * Returns { valid: false, error: string } if invalid.\n */\nfunction validateNumber(input: string): { valid: true; value: number } | { valid: false; error: string } {\n  const trimmed = input.trim();\n\n  // Empty input is invalid for numbers\n  if (trimmed === \"\") {\n    return { valid: false, error: \"Number required\" };\n  }\n\n  const num = Number(trimmed);\n\n  // Check for NaN\n  if (Number.isNaN(num)) {\n    return { valid: false, error: \"Invalid number\" };\n  }\n\n  // Check for Infinity\n  if (!Number.isFinite(num)) {\n    return { valid: false, error: \"Infinity not allowed\" };\n  }\n\n  return { valid: true, value: num };\n}\n\n/**\n * Coerce a value when switching types.\n * String values preserve exact input.\n * Number values only accept valid numbers.\n */\nfunction coerceToType(currentValue: JSONValue, newType: JSONType): JSONValue {\n  switch (newType) {\n    case \"string\":\n      // Convert to string, preserving value\n      if (currentValue === null) return \"null\";\n      if (typeof currentValue === \"object\") return JSON.stringify(currentValue);\n      return String(currentValue);\n    case \"number\": {\n      // Try to parse, default to 0 on failure\n      if (typeof currentValue === \"number\") return currentValue;\n      if (typeof currentValue === \"string\") {\n        const result = validateNumber(currentValue);\n        return result.valid ? result.value : 0;\n      }\n      return 0;\n    }\n    case \"boolean\":\n      return Boolean(currentValue);\n    case \"null\":\n      return null;\n    case \"object\":\n      // Initialize fresh object on type switch\n      return {};\n    case \"array\":\n      // Initialize fresh array on type switch\n      return [];\n  }\n}\n\n// ============================================================================\n// Row Rendering\n// ============================================================================\n\nfunction createRowElement(\n  state: EditorState,\n  key: string,\n  value: JSONValue,\n  type: JSONType,\n  depth: number,\n  onUpdate: () => void,\n  isArrayItem: boolean = false\n): FieldRow {\n  const id = generateRowId();\n  const row: FieldRow = {\n    id,\n    key,\n    value,\n    type,\n    element: null as any,\n    depth,\n    lastValidNumber: typeof value === \"number\" ? value : 0,\n    hasError: false\n  };\n  const isEditable = !state.readonly && !state.disabled;\n\n  const el = document.createElement(\"div\");\n  el.className = `flex items-start gap-2 ${depth > 0 ? \"ml-4 pl-2 border-l-2 border-gray-200 dark:border-gray-700\" : \"\"}`;\n  el.setAttribute(\"data-json-row-id\", id);\n\n  // Key/index input\n  const keyInput = document.createElement(\"input\");\n  keyInput.type = \"text\";\n  keyInput.value = key;\n\n  if (isArrayItem) {\n    // Array items show index as readonly\n    keyInput.placeholder = \"idx\";\n    keyInput.disabled = true;\n    keyInput.readOnly = true;\n    keyInput.className =\n      \"flex-shrink-0 w-16 px-2 py-1.5 text-sm text-center border border-gray-200 rounded-md bg-gray-100 dark:bg-slate-700 dark:border-gray-600 dark:text-gray-300 opacity-60 cursor-not-allowed\";\n  } else {\n    keyInput.placeholder = \"key\";\n    keyInput.disabled = !isEditable;\n    keyInput.readOnly = state.readonly;\n    keyInput.className =\n      \"flex-shrink-0 w-32 px-2 py-1.5 text-sm border border-gray-200 rounded-md bg-white dark:bg-slate-800 dark:border-gray-600 dark:text-gray-200 focus:border-blue-500 focus:ring-1 focus:ring-blue-500\" +\n      (!isEditable ? \" opacity-60 cursor-not-allowed\" : \"\");\n    if (isEditable) {\n      keyInput.addEventListener(\"input\", () => {\n        row.key = keyInput.value;\n        onUpdate();\n      });\n    }\n  }\n\n  // Value input container (varies by type)\n  const valueContainer = document.createElement(\"div\");\n  valueContainer.className = \"flex-1 min-w-0\";\n  renderValueInput(valueContainer, row, state, onUpdate);\n\n  // Type dropdown\n  const typeSelect = document.createElement(\"select\");\n  typeSelect.disabled = !isEditable;\n  typeSelect.className =\n    \"flex-shrink-0 w-24 px-2 py-1.5 text-sm border border-gray-200 rounded-md bg-white dark:bg-slate-800 dark:border-gray-600 dark:text-gray-200 focus:border-blue-500 focus:ring-1 focus:ring-blue-500\" +\n    (!isEditable ? \" opacity-60 cursor-not-allowed\" : \"\");\n  for (const opt of TYPE_OPTIONS) {\n    const option = document.createElement(\"option\");\n    option.value = opt.value;\n    option.textContent = opt.label;\n    option.selected = opt.value === type;\n    typeSelect.appendChild(option);\n  }\n  if (isEditable) {\n    typeSelect.addEventListener(\"change\", () => {\n      const newType = typeSelect.value as JSONType;\n      const prevValue = row.value;\n      row.type = newType;\n      row.hasError = false;\n      row.numberError = undefined;\n\n      if (newType === \"number\") {\n        if (typeof prevValue === \"number\") {\n          row.value = prevValue;\n          row.lastValidNumber = prevValue;\n        } else if (typeof prevValue === \"string\") {\n          const result = validateNumber(prevValue);\n          if (result.valid) {\n            row.value = result.value;\n            row.lastValidNumber = result.value;\n          } else {\n            row.value = row.lastValidNumber ?? 0;\n            row.hasError = true;\n            row.numberError = result.error;\n          }\n        } else {\n          row.value = row.lastValidNumber ?? 0;\n        }\n      } else {\n        row.value = coerceToType(prevValue, newType);\n      }\n      valueContainer.innerHTML = \"\";\n      renderValueInput(valueContainer, row, state, onUpdate);\n      onUpdate();\n    });\n  }\n\n  // Action buttons (only shown when editable)\n  const actions = document.createElement(\"div\");\n  actions.className = \"flex items-center gap-1 flex-shrink-0\";\n\n  if (isEditable) {\n    const moveUpBtn = createActionButton(\"\u2191\", \"Move up\", () => {\n      moveRow(state, row, -1);\n      onUpdate();\n    });\n    const moveDownBtn = createActionButton(\"\u2193\", \"Move down\", () => {\n      moveRow(state, row, 1);\n      onUpdate();\n    });\n    const deleteBtn = createActionButton(\"\u00D7\", \"Delete\", () => {\n      deleteRow(state, row);\n      onUpdate();\n    });\n    deleteBtn.classList.add(\"text-red-500\", \"hover:text-red-700\");\n\n    actions.appendChild(moveUpBtn);\n    actions.appendChild(moveDownBtn);\n    actions.appendChild(deleteBtn);\n  }\n\n  el.appendChild(keyInput);\n  el.appendChild(valueContainer);\n  el.appendChild(typeSelect);\n  el.appendChild(actions);\n\n  row.element = el;\n  return row;\n}\n\nfunction renderValueInput(\n  container: HTMLElement,\n  row: FieldRow,\n  state: EditorState,\n  onUpdate: () => void\n): void {\n  const isEditable = !state.readonly && !state.disabled;\n\n  switch (row.type) {\n    case \"boolean\": {\n      const wrapper = document.createElement(\"div\");\n      wrapper.className = \"flex items-center gap-2 py-1.5\";\n\n      const checkbox = document.createElement(\"input\");\n      checkbox.type = \"checkbox\";\n      checkbox.checked = row.value === true;\n      checkbox.disabled = !isEditable;\n      checkbox.className =\n        \"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500\" +\n        (!isEditable ? \" opacity-60 cursor-not-allowed\" : \"\");\n      if (isEditable) {\n        checkbox.addEventListener(\"change\", () => {\n          row.value = checkbox.checked;\n          onUpdate();\n        });\n      }\n\n      const label = document.createElement(\"span\");\n      label.textContent = row.value ? \"true\" : \"false\";\n      label.className = \"text-sm text-gray-600 dark:text-gray-400\";\n\n      if (isEditable) {\n        checkbox.addEventListener(\"change\", () => {\n          label.textContent = checkbox.checked ? \"true\" : \"false\";\n        });\n      }\n\n      wrapper.appendChild(checkbox);\n      wrapper.appendChild(label);\n      container.appendChild(wrapper);\n      break;\n    }\n    case \"null\": {\n      const nullLabel = document.createElement(\"span\");\n      nullLabel.textContent = \"null\";\n      nullLabel.className = \"text-sm text-gray-400 italic py-1.5 block\";\n      container.appendChild(nullLabel);\n      break;\n    }\n    case \"number\": {\n      const wrapper = document.createElement(\"div\");\n      wrapper.className = \"relative\";\n\n      const input = document.createElement(\"input\");\n      input.type = \"text\"; // Use text to have full control over validation\n      input.inputMode = \"decimal\"; // Mobile keyboard hint\n      input.value = String(row.value ?? 0);\n      input.disabled = !isEditable;\n      input.readOnly = state.readonly;\n      input.className =\n        \"w-full px-2 py-1.5 text-sm border rounded-md bg-white dark:bg-slate-800 dark:text-gray-200 focus:ring-1\" +\n        (row.hasError\n          ? \" border-red-500 focus:border-red-500 focus:ring-red-500\"\n          : \" border-gray-200 dark:border-gray-600 focus:border-blue-500 focus:ring-blue-500\") +\n        (!isEditable ? \" opacity-60 cursor-not-allowed\" : \"\");\n\n      const errorEl = document.createElement(\"span\");\n      errorEl.className = \"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-red-500 hidden\";\n      input.dataset.lastValidNumber = String(row.lastValidNumber ?? 0);\n\n      if (row.hasError) {\n        errorEl.textContent = row.numberError ?? \"Invalid number\";\n        errorEl.classList.remove(\"hidden\");\n      }\n\n      if (isEditable) {\n        input.addEventListener(\"input\", () => {\n          const result = validateNumber(input.value);\n          if (result.valid) {\n            row.value = result.value;\n            row.lastValidNumber = result.value;\n            row.hasError = false;\n            row.numberError = undefined;\n            input.dataset.lastValidNumber = String(result.value);\n            input.classList.remove(\"border-red-500\", \"focus:border-red-500\", \"focus:ring-red-500\");\n            input.classList.add(\"border-gray-200\", \"dark:border-gray-600\", \"focus:border-blue-500\", \"focus:ring-blue-500\");\n            errorEl.classList.add(\"hidden\");\n            onUpdate();\n          } else {\n            // Keep last valid value, show error\n            row.value = row.lastValidNumber ?? 0;\n            row.hasError = true;\n            row.numberError = result.error;\n            input.classList.remove(\"border-gray-200\", \"dark:border-gray-600\", \"focus:border-blue-500\", \"focus:ring-blue-500\");\n            input.classList.add(\"border-red-500\", \"focus:border-red-500\", \"focus:ring-red-500\");\n            errorEl.textContent = result.error;\n            errorEl.classList.remove(\"hidden\");\n            // Don't call onUpdate() - keep last valid value in JSON\n          }\n        });\n\n        // On blur, restore to last valid value if error\n        input.addEventListener(\"blur\", () => {\n          if (row.hasError) {\n            input.value = String(row.lastValidNumber ?? 0);\n            row.hasError = false;\n            row.numberError = undefined;\n            input.dataset.lastValidNumber = String(row.lastValidNumber ?? 0);\n            input.classList.remove(\"border-red-500\", \"focus:border-red-500\", \"focus:ring-red-500\");\n            input.classList.add(\"border-gray-200\", \"dark:border-gray-600\", \"focus:border-blue-500\", \"focus:ring-blue-500\");\n            errorEl.classList.add(\"hidden\");\n          }\n        });\n      }\n\n      wrapper.appendChild(input);\n      wrapper.appendChild(errorEl);\n      container.appendChild(wrapper);\n      break;\n    }\n    case \"object\":\n    case \"array\": {\n      // Inline nested editor\n      const nestedContainer = document.createElement(\"div\");\n      nestedContainer.className = \"space-y-2 py-1\";\n\n      const nestedLabel = document.createElement(\"span\");\n      nestedLabel.textContent = row.type === \"object\" ? \"{ Object }\" : \"[ Array ]\";\n      nestedLabel.className =\n        \"text-xs text-gray-500 dark:text-gray-400 font-medium block mb-1\";\n      nestedContainer.appendChild(nestedLabel);\n\n      const nestedRows = document.createElement(\"div\");\n      nestedRows.className = \"space-y-2\";\n      if (row.type === \"array\") {\n        nestedRows.setAttribute(\"data-json-array\", \"true\");\n      }\n\n      // Render nested rows\n      if (row.type === \"object\" && typeof row.value === \"object\" && row.value !== null && !Array.isArray(row.value)) {\n        for (const [k, v] of Object.entries(row.value)) {\n          const nestedRow = createRowElement(\n            state,\n            k,\n            v,\n            detectType(v),\n            row.depth + 1,\n            () => {\n              // Rebuild object from nested rows\n              const obj: JSONObject = {};\n              nestedRows.querySelectorAll(\":scope > [data-json-row-id]\").forEach((el) => {\n                const keyInput = el.querySelector('input[type=\"text\"]') as HTMLInputElement;\n                if (keyInput && !keyInput.disabled) {\n                  obj[keyInput.value] = getNestedRowValue(el);\n                } else if (keyInput) {\n                  // For disabled key inputs (shouldn't happen in objects, but safety)\n                  obj[keyInput.value] = getNestedRowValue(el);\n                }\n              });\n              row.value = obj;\n              onUpdate();\n            },\n            false // Not an array item\n          );\n          nestedRows.appendChild(nestedRow.element);\n        }\n      } else if (row.type === \"array\" && Array.isArray(row.value)) {\n        row.value.forEach((item, idx) => {\n          const nestedRow = createRowElement(\n            state,\n            String(idx),\n            item,\n            detectType(item),\n            row.depth + 1,\n            () => {\n              // Rebuild array from nested rows\n              const arr: JSONArray = [];\n              nestedRows.querySelectorAll(\":scope > [data-json-row-id]\").forEach((el) => {\n                arr.push(getNestedRowValue(el));\n              });\n              row.value = arr;\n              onUpdate();\n            },\n            true // Is an array item\n          );\n          nestedRows.appendChild(nestedRow.element);\n        });\n      }\n\n      nestedContainer.appendChild(nestedRows);\n\n      // Add button for nested (only when editable)\n      if (isEditable) {\n        const addNestedBtn = document.createElement(\"button\");\n        addNestedBtn.type = \"button\";\n        addNestedBtn.textContent = row.type === \"array\" ? \"+ Add Item\" : \"+ Add Field\";\n        addNestedBtn.className =\n          \"mt-1 text-xs text-blue-600 hover:text-blue-700 dark:text-blue-400\";\n        addNestedBtn.addEventListener(\"click\", () => {\n          const isNestedArray = row.type === \"array\";\n          const newKey = isNestedArray ? String(nestedRows.children.length) : \"\";\n          const nestedRow = createRowElement(\n            state,\n            newKey,\n            \"\",\n            \"string\",\n            row.depth + 1,\n            () => {\n              if (row.type === \"object\") {\n                const obj: JSONObject = {};\n                nestedRows.querySelectorAll(\":scope > [data-json-row-id]\").forEach((el) => {\n                  const keyInput = el.querySelector('input[type=\"text\"]') as HTMLInputElement;\n                  if (keyInput) obj[keyInput.value] = getNestedRowValue(el);\n                });\n                row.value = obj;\n              } else {\n                const arr: JSONArray = [];\n                nestedRows.querySelectorAll(\":scope > [data-json-row-id]\").forEach((el) => {\n                  arr.push(getNestedRowValue(el));\n                });\n                row.value = arr;\n              }\n              if (row.type === \"array\") {\n                syncArrayRowKeys(nestedRows);\n              }\n              onUpdate();\n            },\n            isNestedArray\n          );\n          nestedRows.appendChild(nestedRow.element);\n\n          // Trigger update\n          if (row.type === \"object\") {\n            const obj: JSONObject = {};\n            nestedRows.querySelectorAll(\":scope > [data-json-row-id]\").forEach((el) => {\n              const keyInput = el.querySelector('input[type=\"text\"]') as HTMLInputElement;\n              if (keyInput) obj[keyInput.value] = getNestedRowValue(el);\n            });\n            row.value = obj;\n          } else {\n            const arr: JSONArray = [];\n            nestedRows.querySelectorAll(\":scope > [data-json-row-id]\").forEach((el) => {\n              arr.push(getNestedRowValue(el));\n            });\n            row.value = arr;\n          }\n          if (row.type === \"array\") {\n            syncArrayRowKeys(nestedRows);\n          }\n          onUpdate();\n        });\n        nestedContainer.appendChild(addNestedBtn);\n      }\n\n      container.appendChild(nestedContainer);\n      break;\n    }\n    default: {\n      // String - preserves exact input\n      const input = document.createElement(\"input\");\n      input.type = \"text\";\n      input.value = String(row.value ?? \"\");\n      input.disabled = !isEditable;\n      input.readOnly = state.readonly;\n      input.className =\n        \"w-full px-2 py-1.5 text-sm border border-gray-200 rounded-md bg-white dark:bg-slate-800 dark:border-gray-600 dark:text-gray-200 focus:border-blue-500 focus:ring-1 focus:ring-blue-500\" +\n        (!isEditable ? \" opacity-60 cursor-not-allowed\" : \"\");\n      if (isEditable) {\n        input.addEventListener(\"input\", () => {\n          // Preserve exact string input - no coercion\n          row.value = input.value;\n          onUpdate();\n        });\n      }\n      container.appendChild(input);\n    }\n  }\n}\n\nfunction getNestedRowValue(rowEl: Element): JSONValue {\n  // Get value from a row element\n  const typeSelect = rowEl.querySelector(\"select\") as HTMLSelectElement;\n  const type = (typeSelect?.value || \"string\") as JSONType;\n\n  switch (type) {\n    case \"boolean\": {\n      const checkbox = rowEl.querySelector('input[type=\"checkbox\"]') as HTMLInputElement;\n      return checkbox?.checked ?? false;\n    }\n    case \"null\":\n      return null;\n    case \"number\": {\n      // Get from text input (we use text type for validation)\n      const input = rowEl.querySelector('input[type=\"text\"][inputmode=\"decimal\"]') as HTMLInputElement;\n      if (input) {\n        const result = validateNumber(input.value);\n        if (result.valid) {\n          return result.value;\n        }\n        const lastValid = input.dataset.lastValidNumber;\n        if (lastValid !== undefined && lastValid !== \"\") {\n          return Number(lastValid);\n        }\n        return 0;\n      }\n      // Fallback to number input\n      const numInput = rowEl.querySelector('input[type=\"number\"]') as HTMLInputElement;\n      return parseFloat(numInput?.value ?? \"0\") || 0;\n    }\n    case \"object\":\n    case \"array\": {\n      // Recursively collect nested values\n      const nestedRows = rowEl.querySelectorAll(\":scope > div > div > div > [data-json-row-id]\");\n      if (type === \"object\") {\n        const obj: JSONObject = {};\n        nestedRows.forEach((el) => {\n          const keyInput = el.querySelector('input[type=\"text\"]') as HTMLInputElement;\n          if (keyInput) obj[keyInput.value] = getNestedRowValue(el);\n        });\n        return obj;\n      } else {\n        const arr: JSONArray = [];\n        nestedRows.forEach((el) => arr.push(getNestedRowValue(el)));\n        return arr;\n      }\n    }\n    default: {\n      // String - find the value input (not the key input)\n      const inputs = rowEl.querySelectorAll('input[type=\"text\"]');\n      // The value input is the one that's not disabled (for objects) or the second one (for arrays)\n      for (let i = inputs.length - 1; i >= 0; i--) {\n        const input = inputs[i] as HTMLInputElement;\n        // Skip key inputs (first input, or disabled inputs for arrays)\n        if (i > 0 || (!input.disabled && input.placeholder !== \"key\" && input.placeholder !== \"idx\")) {\n          return input.value ?? \"\";\n        }\n      }\n      // Fallback: second input is value\n      if (inputs.length > 1) {\n        return (inputs[1] as HTMLInputElement).value ?? \"\";\n      }\n      return \"\";\n    }\n  }\n}\n\nfunction syncArrayRowKeys(container: Element | null): void {\n  if (!container) {\n    return;\n  }\n  const rows = Array.from(container.querySelectorAll<HTMLElement>(\":scope > [data-json-row-id]\"));\n  rows.forEach((rowEl, index) => {\n    const keyInput = rowEl.querySelector('input[type=\"text\"]') as HTMLInputElement | null;\n    if (keyInput) {\n      keyInput.value = String(index);\n    }\n  });\n}\n\nfunction createActionButton(\n  label: string,\n  title: string,\n  onClick: () => void\n): HTMLButtonElement {\n  const btn = document.createElement(\"button\");\n  btn.type = \"button\";\n  btn.textContent = label;\n  btn.title = title;\n  btn.className =\n    \"w-6 h-6 flex items-center justify-center text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700\";\n  btn.addEventListener(\"click\", (e) => {\n    e.preventDefault();\n    onClick();\n  });\n  return btn;\n}\n\n// ============================================================================\n// State Management\n// ============================================================================\n\nfunction moveRow(state: EditorState, row: FieldRow, direction: -1 | 1): void {\n  const idx = state.rows.indexOf(row);\n  if (idx !== -1) {\n    // Root-level row\n    const newIdx = idx + direction;\n    if (newIdx < 0 || newIdx >= state.rows.length) return;\n\n    // Swap in array\n    [state.rows[idx], state.rows[newIdx]] = [state.rows[newIdx], state.rows[idx]];\n\n    // Swap in DOM\n    if (state.rowsContainer) {\n      const elements = Array.from(state.rowsContainer.children);\n      if (direction === -1 && idx > 0) {\n        state.rowsContainer.insertBefore(elements[idx], elements[idx - 1]);\n      } else if (direction === 1 && idx < elements.length - 1) {\n        state.rowsContainer.insertBefore(elements[idx + 1], elements[idx]);\n      }\n      if (state.rootType === \"array\") {\n        syncArrayRowKeys(state.rowsContainer);\n      }\n    }\n    return;\n  }\n\n  // Nested row\n  const container = row.element.parentElement;\n  if (!container) {\n    return;\n  }\n  const elements = Array.from(\n    container.querySelectorAll<HTMLElement>(\":scope > [data-json-row-id]\")\n  );\n  const currentIdx = elements.indexOf(row.element);\n  if (currentIdx === -1) {\n    return;\n  }\n  const newIdx = currentIdx + direction;\n  if (newIdx < 0 || newIdx >= elements.length) {\n    return;\n  }\n  if (direction === -1) {\n    container.insertBefore(elements[currentIdx], elements[newIdx]);\n  } else {\n    container.insertBefore(elements[newIdx], elements[currentIdx]);\n  }\n  if (container.getAttribute(\"data-json-array\") === \"true\") {\n    syncArrayRowKeys(container);\n  }\n}\n\nfunction deleteRow(state: EditorState, row: FieldRow): void {\n  const idx = state.rows.indexOf(row);\n  if (idx !== -1) {\n    // Root-level row\n    state.rows.splice(idx, 1);\n    row.element.remove();\n    if (state.rootType === \"array\") {\n      syncArrayRowKeys(state.rowsContainer);\n    }\n    return;\n  }\n\n  // Nested row\n  const container = row.element.parentElement;\n  row.element.remove();\n  if (container && container.getAttribute(\"data-json-array\") === \"true\") {\n    syncArrayRowKeys(container);\n  }\n}\n\nfunction addRow(state: EditorState, onUpdate: () => void): void {\n  if (state.readonly || state.disabled) return;\n\n  const isArray = state.rootType === \"array\";\n  const key = isArray ? String(state.rows.length) : \"\";\n  const row = createRowElement(state, key, \"\", \"string\", 0, onUpdate, isArray);\n  state.rows.push(row);\n  state.rowsContainer?.appendChild(row.element);\n\n  if (isArray) {\n    syncArrayRowKeys(state.rowsContainer);\n  }\n  onUpdate();\n}\n\nfunction buildJSONFromRows(state: EditorState): JSONValue {\n  if (state.rootType === \"array\") {\n    return state.rows.map((row) => row.value);\n  }\n  const result: JSONObject = {};\n  for (const row of state.rows) {\n    if (row.key.trim()) {\n      result[row.key] = row.value;\n    }\n  }\n  return result;\n}\n\nfunction syncToTextarea(state: EditorState): void {\n  const json = buildJSONFromRows(state);\n  const str = stringifyJSON(json);\n\n  // Sync to textarea if present\n  if (state.textarea) {\n    state.textarea.value = str;\n  }\n\n  // Update preview if present\n  if (state.preview) {\n    state.preview.textContent = str;\n  }\n\n  // Clear parse error and update state\n  state.parseError = null;\n  state.root.setAttribute(\"data-json-editor-state\", \"valid\");\n\n  // Update add button text\n  updateAddButtonText(state);\n}\n\nfunction updateAddButtonText(state: EditorState): void {\n  if (!state.addButton) return;\n\n  // Find the text node or span inside the button\n  const textSpan = state.addButton.querySelector(\"span\") || state.addButton.lastChild;\n  const newText = state.rootType === \"array\" ? \"Add Item\" : \"Add Field\";\n\n  if (textSpan && textSpan.nodeType === Node.TEXT_NODE) {\n    textSpan.textContent = newText;\n  } else if (textSpan && textSpan instanceof HTMLElement) {\n    textSpan.textContent = newText;\n  } else {\n    // Button has mixed content, find text node\n    for (const child of state.addButton.childNodes) {\n      if (child.nodeType === Node.TEXT_NODE && child.textContent?.trim()) {\n        child.textContent = ` ${newText}`;\n        break;\n      }\n    }\n  }\n}\n\nfunction populateRowsFromJSON(state: EditorState, json: JSONValue): void {\n  state.rows = [];\n  if (state.rowsContainer) {\n    state.rowsContainer.innerHTML = \"\";\n  }\n\n  const onUpdate = () => syncToTextarea(state);\n\n  if (!state.rowsContainer) {\n    return;\n  }\n\n  // Detect root type from JSON\n  if (Array.isArray(json)) {\n    state.rootType = \"array\";\n    state.rowsContainer.setAttribute(\"data-json-array\", \"true\");\n    json.forEach((value, index) => {\n      const type = detectType(value);\n      const row = createRowElement(state, String(index), value, type, 0, onUpdate, true);\n      state.rows.push(row);\n      state.rowsContainer?.appendChild(row.element);\n    });\n    syncArrayRowKeys(state.rowsContainer);\n  } else if (json && typeof json === \"object\") {\n    state.rootType = \"object\";\n    state.rowsContainer.removeAttribute(\"data-json-array\");\n    for (const [key, value] of Object.entries(json)) {\n      const type = detectType(value);\n      const row = createRowElement(state, key, value, type, 0, onUpdate, false);\n      state.rows.push(row);\n      state.rowsContainer?.appendChild(row.element);\n    }\n  } else {\n    // Primitive at root - wrap in object (shouldn't happen normally)\n    state.rootType = \"object\";\n    state.rowsContainer.removeAttribute(\"data-json-array\");\n  }\n\n  // Update button text\n  updateAddButtonText(state);\n}\n\nfunction showParseError(state: EditorState, error: string): void {\n  state.parseError = error;\n  state.root.setAttribute(\"data-json-editor-state\", \"invalid\");\n\n  // Could add a visible error message element here if needed\n  if (state.preview) {\n    state.preview.setAttribute(\"data-state\", \"invalid\");\n  }\n}\n\n// ============================================================================\n// Mode Toggle\n// ============================================================================\n\nfunction setActiveView(state: EditorState, view: \"raw\" | \"gui\"): void {\n  state.activeView = view;\n  state.root.setAttribute(\"data-json-editor-active\", view);\n\n  // Toggle visibility\n  if (state.guiContainer) {\n    state.guiContainer.classList.toggle(\"hidden\", view !== \"gui\");\n  }\n  if (state.textarea) {\n    state.textarea.classList.toggle(\"hidden\", view !== \"raw\");\n  }\n  if (state.preview) {\n    state.preview.classList.add(\"hidden\");\n  }\n\n  // Update toggle buttons\n  const toggleBtns = state.root.querySelectorAll(\"[data-json-editor-mode-btn]\");\n  toggleBtns.forEach((btn) => {\n    const mode = btn.getAttribute(\"data-json-editor-mode-btn\");\n    const isActive = mode === view;\n    btn.classList.toggle(\"bg-blue-600\", isActive);\n    btn.classList.toggle(\"text-white\", isActive);\n    btn.classList.toggle(\"border-blue-600\", isActive);\n    btn.classList.toggle(\"hover:bg-blue-700\", isActive);\n    btn.classList.toggle(\"bg-white\", !isActive);\n    btn.classList.toggle(\"text-gray-700\", !isActive);\n    btn.classList.toggle(\"border-gray-200\", !isActive);\n    btn.classList.toggle(\"hover:bg-gray-50\", !isActive);\n  });\n\n  // Sync data when switching views\n  if (view === \"gui\" && state.textarea) {\n    // Sync from textarea to GUI\n    const parsed = parseJSON(state.textarea.value || \"{}\");\n    if (parsed !== undefined) {\n      if (typeof parsed === \"object\" || Array.isArray(parsed)) {\n        populateRowsFromJSON(state, parsed);\n        state.parseError = null;\n      } else {\n        showParseError(state, \"Root must be an object or array\");\n      }\n    } else {\n      // Parse error - keep GUI state, show error\n      showParseError(state, \"Invalid JSON in raw editor\");\n    }\n  } else if (view === \"raw\") {\n    // Sync from GUI to textarea\n    syncToTextarea(state);\n  }\n}\n\n// ============================================================================\n// Initialization\n// ============================================================================\n\nfunction initEditor(root: HTMLElement): void {\n  if (root.getAttribute(INIT_ATTR) === \"true\") return;\n  root.setAttribute(INIT_ATTR, \"true\");\n\n  const textarea = root.querySelector(\"[data-json-editor-input]\") as HTMLTextAreaElement | null;\n  const preview = root.querySelector(\"[data-json-editor-preview]\") as HTMLPreElement | null;\n  const guiContainer = root.querySelector(\"[data-json-editor-gui]\") as HTMLElement | null;\n  const rowsContainer = root.querySelector(\"[data-json-editor-rows]\") as HTMLElement | null;\n  const addFieldBtn = root.querySelector(\"[data-json-editor-add-field]\") as HTMLButtonElement | null;\n  const modeToggle = root.querySelector(\"[data-json-editor-mode-toggle]\") as HTMLElement | null;\n  const formatBtn = root.querySelector(\"[data-json-editor-format]\") as HTMLButtonElement | null;\n  const collapseToggle = root.querySelector(\"[data-json-editor-toggle]\") as HTMLButtonElement | null;\n\n  const mode = (root.getAttribute(\"data-json-editor-mode\") || \"raw\") as \"raw\" | \"gui\" | \"hybrid\";\n  const activeView = (root.getAttribute(\"data-json-editor-active\") || \"raw\") as \"raw\" | \"gui\";\n\n  // Read readonly/disabled from data attributes\n  const isReadonly = root.getAttribute(\"data-json-editor-readonly\") === \"true\";\n  const isDisabled = root.getAttribute(\"data-json-editor-disabled\") === \"true\";\n\n  const state: EditorState = {\n    root,\n    textarea,\n    preview,\n    guiContainer,\n    rowsContainer,\n    addButton: addFieldBtn,\n    rows: [],\n    mode,\n    activeView,\n    readonly: isReadonly,\n    disabled: isDisabled,\n    rootType: \"object\",\n    parseError: null,\n  };\n\n  let initialValue = \"{}\";\n  if (textarea) {\n    initialValue = textarea.value || \"{}\";\n  }\n\n  const onUpdate = () => syncToTextarea(state);\n\n  // Parse initial value and populate GUI\n  if (guiContainer && rowsContainer) {\n    const parsed = parseJSON(initialValue);\n    if (parsed !== undefined) {\n      if (typeof parsed === \"object\" || Array.isArray(parsed)) {\n        // Determine root type from initial value\n        state.rootType = detectRootType(parsed);\n        populateRowsFromJSON(state, parsed);\n      } else {\n        state.rootType = \"object\";\n        showParseError(state, \"Root must be an object or array\");\n        updateAddButtonText(state);\n      }\n    } else {\n      // Invalid initial JSON - start with empty object\n      state.rootType = \"object\";\n      showParseError(state, \"Invalid initial JSON\");\n      updateAddButtonText(state);\n    }\n  }\n\n  // Mode toggle handler\n  if (modeToggle && !isDisabled) {\n    modeToggle.querySelectorAll(\"[data-json-editor-mode-btn]\").forEach((btn) => {\n      btn.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n        const targetMode = btn.getAttribute(\"data-json-editor-mode-btn\") as \"raw\" | \"gui\";\n        setActiveView(state, targetMode);\n      });\n    });\n  }\n\n  if (!isReadonly && !isDisabled) {\n    // Add field/item button\n    if (addFieldBtn) {\n      addFieldBtn.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n        addRow(state, onUpdate);\n      });\n    }\n\n    // Raw editor: sync from textarea to preview/state\n    if (textarea) {\n      textarea.addEventListener(\"input\", () => {\n        const parsed = parseJSON(textarea.value);\n        const valid = parsed !== undefined;\n        state.root.setAttribute(\"data-json-editor-state\", valid ? \"valid\" : \"invalid\");\n\n        if (valid) {\n          state.parseError = null;\n          // Update rootType if parsed successfully\n          if (typeof parsed === \"object\" || Array.isArray(parsed)) {\n            state.rootType = detectRootType(parsed);\n          }\n        } else {\n          state.parseError = \"Invalid JSON\";\n        }\n\n        if (preview) {\n          preview.textContent = valid ? stringifyJSON(parsed) : textarea.value;\n          preview.setAttribute(\"data-state\", valid ? \"valid\" : \"invalid\");\n        }\n      });\n    }\n\n    // Format button\n    if (formatBtn && textarea) {\n      formatBtn.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n        const parsed = parseJSON(textarea.value);\n        if (parsed !== undefined) {\n          textarea.value = stringifyJSON(parsed);\n        }\n      });\n    }\n  }\n\n  // Collapse toggle works even in readonly mode (it's just for viewing)\n  if (collapseToggle && textarea && preview) {\n    collapseToggle.addEventListener(\"click\", (e) => {\n      e.preventDefault();\n      const isCollapsed = root.classList.contains(\"json-editor--collapsed\");\n      root.classList.toggle(\"json-editor--collapsed\", !isCollapsed);\n      textarea.classList.toggle(\"hidden\", !isCollapsed);\n      preview.classList.toggle(\"hidden\", isCollapsed);\n      collapseToggle.textContent = isCollapsed ? \"Collapse\" : \"Expand\";\n      collapseToggle.setAttribute(\"aria-expanded\", isCollapsed ? \"true\" : \"false\");\n    });\n  }\n}\n\nexport function initJSONEditors(): void {\n  document.querySelectorAll<HTMLElement>(ROOT_SELECTOR).forEach(initEditor);\n}\n\n// Auto-init on DOMContentLoaded\nif (typeof document !== \"undefined\") {\n  if (document.readyState === \"loading\") {\n    document.addEventListener(\"DOMContentLoaded\", initJSONEditors);\n  } else {\n    initJSONEditors();\n  }\n}\n"],
  "mappings": "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",
  "names": ["behaviors_exports", "__export", "__resetBehaviorsForTests", "autoResize", "autoSlug", "initBehaviors", "initIcons", "initJSONEditors", "registerBehavior", "registerIconProvider", "slugify", "slugify", "input", "normalizeBehaviorName", "name", "_a", "collectBehaviorElements", "root", "scope", "elements", "parseBehaviorNames", "raw", "tokens", "token", "parseBehaviorConfig", "error", "selectBehaviorConfig", "parsed", "total", "record", "resolveRootElement", "element", "_b", "_c", "nearest", "isInputControl", "node", "findNearestInput", "findFieldInput", "key", "attrSelector", "idSelector", "buildElementID", "escaped", "autoSlug", "element", "config", "root", "target", "findNearestInput", "options", "normaliseConfig", "source", "findFieldInput", "syncing", "manual", "updateSlug", "nextValue", "slugify", "handleSourceInput", "handleTargetInput", "event", "record", "autoResize", "element", "config", "target", "findNearestInput", "options", "normaliseConfig", "rowsConfig", "normaliseBounds", "resize", "_a", "computed", "lineHeight", "resolveLineHeightPx", "paddingTop", "paddingBottom", "borderTop", "borderBottom", "chrome", "minRows", "maxRows", "minHeight", "maxHeight", "nextHeight", "handleInput", "record", "coercePositiveInt", "value", "parsed", "normalized", "raw", "fontSize", "factories", "instances", "registerBehavior", "name", "factory", "normalized", "normalizeBehaviorName", "initBehaviors", "root", "elements", "collectBehaviorElements", "records", "element", "names", "parseBehaviorNames", "configPayload", "parseBehaviorConfig", "scopeRoot", "resolveRootElement", "rawName", "hasActiveInstance", "contextConfig", "selectBehaviorConfig", "dispose", "invokeFactory", "setActiveInstance", "record", "error", "clearActiveInstance", "resetBehaviorRegistry", "context", "teardown", "getInstanceMap", "map", "providers", "registerIconProvider", "source", "provider", "normalized", "normalize", "initIcons", "root", "_a", "_b", "elements", "collectIconElements", "records", "element", "name", "svgMarkup", "safeInvokeProvider", "svg", "parseSvgMarkup", "host", "resolveIconHost", "wrapper", "__resetIconProvidersForTests", "scope", "parent", "previous", "error", "markup", "doc", "trimmed", "sanitizeSvg", "node", "all", "attrs", "attr", "value", "ROOT_SELECTOR", "INIT_ATTR", "TYPE_OPTIONS", "rowIdCounter", "generateRowId", "parseJSON", "value", "stringifyJSON", "detectType", "detectRootType", "validateNumber", "input", "trimmed", "num", "coerceToType", "currentValue", "newType", "result", "createRowElement", "state", "key", "value", "type", "depth", "onUpdate", "isArrayItem", "id", "generateRowId", "row", "isEditable", "el", "keyInput", "valueContainer", "renderValueInput", "typeSelect", "opt", "TYPE_OPTIONS", "option", "_a", "_b", "prevValue", "actions", "moveUpBtn", "createActionButton", "moveRow", "moveDownBtn", "deleteBtn", "deleteRow", "container", "_c", "_d", "wrapper", "checkbox", "label", "nullLabel", "errorEl", "nestedContainer", "nestedLabel", "nestedRows", "k", "v", "nestedRow", "detectType", "obj", "getNestedRowValue", "item", "idx", "arr", "addNestedBtn", "isNestedArray", "newKey", "syncArrayRowKeys", "rowEl", "lastValid", "numInput", "inputs", "i", "index", "title", "onClick", "btn", "e", "direction", "newIdx", "elements", "currentIdx", "addRow", "isArray", "buildJSONFromRows", "syncToTextarea", "json", "str", "stringifyJSON", "updateAddButtonText", "textSpan", "newText", "child", "populateRowsFromJSON", "showParseError", "error", "setActiveView", "view", "isActive", "parsed", "parseJSON", "initEditor", "root", "INIT_ATTR", "textarea", "preview", "guiContainer", "rowsContainer", "addFieldBtn", "modeToggle", "formatBtn", "collapseToggle", "mode", "activeView", "isReadonly", "isDisabled", "initialValue", "detectRootType", "targetMode", "valid", "isCollapsed", "initJSONEditors", "ROOT_SELECTOR", "registerDefaults", "registerBehavior", "autoSlug", "autoResize", "initBehaviors", "root", "result", "initIcons", "initJSONEditors", "__resetBehaviorsForTests", "resetBehaviorRegistry", "__resetIconProvidersForTests", "registerDefaults"]
}
