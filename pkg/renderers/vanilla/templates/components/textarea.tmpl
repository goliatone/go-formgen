{% set data_attrs = field.metadata.__data_attrs -%}
{% set row_count = field.uiHints.rows -%}
{% if not row_count %}
{% set row_count = 4 %}
{% endif %}
{% set icon_value = field.uiHints.icon -%}
{% set icon_raw = field.uiHints.iconRaw -%}
{% set has_icon = icon_value or icon_raw -%}
{% set validation_state = field.metadata["validation.state"] -%}
{% set readonly_value = field.readonly or field.uiHints.readonly == "true" or field.metadata.readonly == "true" or field.metadata["prefill.readonly"] == "true" -%}
{% set disabled_value = field.disabled or field.uiHints.disabled == "true" or field.metadata.disabled == "true" or field.metadata["prefill.disabled"] == "true" -%}
{% set provenance = field.metadata["prefill.provenance"] -%}

{% if has_icon %}
<div class="relative">
    <span class="absolute inset-y-3 start-3 flex items-start text-gray-400 pointer-events-none dark:text-gray-500" aria-hidden="true">
        {% if icon_raw %}
        <span class="inline-flex size-5 text-current">{{ icon_raw|safe }}</span>
        {% else %}
        <span class="inline-flex size-4 rounded-full bg-gray-200 dark:bg-gray-600"></span>
        {% endif %}
    </span>
{% endif %}

<textarea
    id="fg-{{ field.name }}"
    name="{{ field.name }}"
    class="py-3 px-4 block w-full border {% if validation_state == "invalid" %}border-red-500{% else %}border-gray-200{% endif %} rounded-lg text-sm {% if validation_state == "invalid" %}focus:border-red-500 focus:ring-red-500{% else %}focus:border-blue-500 focus:ring-blue-500{% endif %} disabled:opacity-50 disabled:pointer-events-none dark:bg-slate-900 dark:text-gray-400 {% if validation_state == "invalid" %}dark:border-red-500 dark:focus:ring-red-500{% else %}dark:border-gray-700 dark:focus:ring-gray-600{% endif %}{% if has_icon %} ps-11{% endif %}"
    rows="{{ row_count }}"
    {% if field.placeholder %}placeholder="{{ field.placeholder }}"{% endif %}
    {% if field.required %}required{% endif %}
    {% if disabled_value %}disabled{% endif %}
    {% if readonly_value %}readonly{% endif %}
    {% if readonly_value %}aria-readonly="true"{% endif %}
    {% if field.maxLength or field.maxLength == 0 %}maxlength="{{ field.maxLength }}"{% endif %}
    {% if validation_state == "invalid" %}aria-invalid="true"{% endif %}
    {% if provenance %}data-prefill-provenance="{{ provenance }}"{% endif %}
    {% if data_attrs %}{{ data_attrs|safe }}{% endif %}
>{% if field.default %}{{ field.default }}{% endif %}</textarea>
{% if has_icon %}
</div>
{% endif %}
