{% set rel = field.relationship -%}
{% set data_attrs = field.metadata.__data_attrs -%}
{% set validation_state = field.metadata["validation.state"] -%}
{% set icon_value = field.uiHints.icon -%}
{% set icon_raw = field.uiHints.iconRaw -%}
{% set has_icon = icon_value or icon_raw -%}

{% if has_icon %}
<div class="relative">
    <span class="absolute inset-y-0 start-3 flex items-center text-gray-400 pointer-events-none dark:text-gray-500" aria-hidden="true">
        {% if icon_raw %}
        <span class="inline-flex size-5 text-current">{{ icon_raw|safe }}</span>
        {% else %}
        <span class="inline-flex size-4 rounded-full bg-gray-200 dark:bg-gray-600"></span>
        {% endif %}
    </span>
{% endif %}

<select
    id="fg-{{ field.name }}"
    name="{{ field.name }}"
    class="py-3 px-4 pe-9 block w-full border rounded-lg text-sm disabled:opacity-50 disabled:pointer-events-none dark:bg-slate-900 dark:text-gray-400{% if has_icon %} ps-11{% endif %}{% if validation_state == "invalid" %} border-red-500 focus:border-red-500 focus:ring-red-500 dark:border-red-500{% else %} border-gray-200 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-700 dark:focus:ring-gray-600{% endif %}"
    {% if field.required %}required{% endif %}
    {% if field.disabled %}disabled{% endif %}
    {% if rel and rel.cardinality == "many" %}multiple data-relationship-collection="many"{% endif %}
    {% if rel and rel.kind %}data-relationship-type="{{ rel.kind }}"{% endif %}
    {% if rel and rel.target %}data-relationship-target="{{ rel.target }}"{% endif %}
    {% if rel and rel.cardinality %}data-relationship-cardinality="{{ rel.cardinality }}"{% endif %}
    {% if validation_state == "invalid" %}aria-invalid="true"{% endif %}
    {% if data_attrs %}{{ data_attrs|safe }}{% endif %}
>
    {% if field.enum %}
        {% for option in field.enum %}
            <option value="{{ option }}"{% if field.default and option == field.default %} selected{% endif %}>{{ option }}</option>
        {% endfor %}
    {% else %}
        {% if field.uiHints.placeholder %}
            <option value="">{{ field.uiHints.placeholder }}</option>
        {% elif field.label %}
            <option value="">Select {{ field.label }}</option>
        {% else %}
            <option value="">Select an option</option>
        {% endif %}
    {% endif %}
</select>
{% if has_icon %}
</div>
{% endif %}
