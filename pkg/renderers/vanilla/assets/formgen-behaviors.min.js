/**
 * formgen relationship runtime
 * DO NOT EDIT: generated via `npm run build`
 */
"use strict";var FormgenBehaviors=(()=>{var g=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var S=Object.prototype.hasOwnProperty;var D=(e,t)=>{for(var n in t)g(e,n,{get:t[n],enumerable:!0})},R=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of F(t))!S.call(e,o)&&o!==n&&g(e,o,{get:()=>t[o],enumerable:!(r=I(t,o))||r.enumerable});return e};var C=e=>R(g({},"__esModule",{value:!0}),e);var W={};D(W,{__resetBehaviorsForTests:()=>P,autoSlug:()=>v,initBehaviors:()=>x,registerBehavior:()=>y,slugify:()=>m});function m(e){return e?e.normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9\s-]/g," ").trim().replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"").toLowerCase():""}function d(e){var t;return(t=e==null?void 0:e.trim().toLowerCase())!=null?t:""}function E(e){let t=(e instanceof Document,e),n=Array.from(t.querySelectorAll("[data-behavior]"));return e instanceof HTMLElement&&e.hasAttribute("data-behavior")&&n.unshift(e),n}function T(e){if(!e)return[];let t=e.split(/[\s,]+/).map(n=>d(n)).filter(Boolean);return Array.from(new Set(t))}function M(e){if(e)try{return JSON.parse(e)}catch(t){console.warn("[formgen:behaviors] failed to parse data-behavior-config:",t);return}}function L(e,t,n){if(e&&typeof e=="object"&&e!==null){let r=e;return Object.prototype.hasOwnProperty.call(r,t)?r[t]:n===1?e:void 0}if(n===1)return e}function b(e,t){var r,o,a;let n=e.closest("[data-formgen-auto-init]");return n||(t instanceof HTMLElement?t:(a=(o=t.body)!=null?o:(r=e.ownerDocument)==null?void 0:r.body)!=null?a:e)}function N(e){return!!e&&(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement)}function B(e){return N(e)?e:e.querySelector("input, textarea")}function H(e,t){var o;if(!t)return null;let n=`[name="${t}"]`,r=`#${k(t)}`;return(o=e.querySelector(n))!=null?o:e.querySelector(r)}function k(e){let t=e.replace(/[^a-zA-Z0-9_-]/g,"-");return t.startsWith("fg-")?t:`fg-${t}`}var v=({element:e,config:t,root:n})=>{let r=B(e);if(!r){console.warn("[formgen:behaviors] autoSlug requires an input or textarea target.");return}let o=z(t);if(!o.source){console.warn("[formgen:behaviors] autoSlug config must define a source field.");return}let a=H(n,o.source);if(!a){console.warn(`[formgen:behaviors] source field "${o.source}" not found for autoSlug.`);return}let f=!1,s=e.getAttribute("data-behavior-state")==="manual";!s&&r.value.trim().length>0&&(s=!0,e.setAttribute("data-behavior-state","manual"));let i=()=>{if(s)return;let u=m(a.value||"");u!==r.value&&(f=!0,r.value=u,r.dispatchEvent(new Event("input",{bubbles:!0})),f=!1)},l=()=>{i()},p=u=>{if(f)return;if(r.value.trim().length===0){s=!1,e.removeAttribute("data-behavior-state"),i();return}s=!0,e.setAttribute("data-behavior-state","manual")};return a.addEventListener("input",l),r.addEventListener("input",p),i(),()=>{a.removeEventListener("input",l),r.removeEventListener("input",p)}};function z(e){if(typeof e=="string")return{source:e};if(e&&typeof e=="object"){let t=e;return{source:typeof t.source=="string"?t.source:void 0}}return{}}var h=new Map,c=new WeakMap;function y(e,t){let n=d(e);!n||typeof t!="function"||h.set(n,t)}function x(e=document){let t=E(e),n=[];for(let r of t){let o=T(r.getAttribute("data-behavior"));if(o.length===0)continue;let a=M(r.getAttribute("data-behavior-config")),f=b(r,e);for(let s of o){let i=d(s);if(!i||j(r,i))continue;let l=h.get(i);if(!l){console.warn(`[formgen:behaviors] behavior "${i}" is not registered.`);continue}let p=L(a,i,o.length),u=$(l,{element:r,name:i,root:f,config:p});_(r,i,u),n.push({element:r,name:i,dispose:u})}}return{records:n,dispose:()=>{for(let r of n.splice(0)){if(r.dispose)try{r.dispose()}catch(o){console.warn(`[formgen:behaviors] dispose failed for ${r.name}:`,o)}O(r.element,r.name)}}}}function w(){h.clear(),c=new WeakMap}function $(e,t){let n;try{n=e(t)}catch(r){console.warn(`[formgen:behaviors] factory for "${t.name}" failed:`,r);return}if(typeof n=="function")return n;if(n&&typeof n=="object"&&typeof n.dispose=="function")return()=>n.dispose()}function q(e){let t=c.get(e);return t||(t=new Map,c.set(e,t)),t}function j(e,t){let n=c.get(e);return n?n.has(t):!1}function _(e,t,n){q(e).set(t,n)}function O(e,t){let n=c.get(e);n&&(n.delete(t),n.size===0&&c.delete(e))}A();function A(){y("autoSlug",v)}function P(){w(),A()}return C(W);})();
//# sourceMappingURL=formgen-behaviors.min.js.map
