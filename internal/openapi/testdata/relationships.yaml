openapi: 3.0.3
info:
  title: Relationship fixture
  version: "1.0"
paths:
  /articles:
    post:
      operationId: createArticle
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              x-formgen-relations:
                includes:
                  - author
                  - author.manager
                  - tags
                relations:
                  - name: author
                    filters:
                      - field: full_name
                        operator: ilike
                  - name: tags
                    filters:
                      - field: label
                        operator: ilike
                tree:
                  name: article
                  children:
                    author:
                      name: author
                      children:
                        manager:
                          name: manager
                    tags:
                      name: tags
              required:
                - author_id
              properties:
                author:
                  allOf:
                    - $ref: '#/components/schemas/Author'
                  type: object
                  x-relationships:
                    type: belongsTo
                    target: '#/components/schemas/Author'
                    foreignKey: author_id
                title:
                  type: string
                author_id:
                  $ref: '#/components/schemas/UUID'
                manager:
                  type: object
                  x-relationships:
                    type: hasOne
                    target: '#/components/schemas/Manager'
                    foreignKey: manager_id
                manager_id:
                  type: string
                category_id:
                  type: string
                  x-relationships:
                    type: belongsTo
                    target: '#/components/schemas/Category'
                tags:
                  type: array
                  items:
                    $ref: '#/components/schemas/Tag'
                  x-relationships:
                    type: hasMany
                    target: '#/components/schemas/Tag'
                    inverse: article
      responses:
        '204':
          description: Accepted
components:
  schemas:
    Author:
      type: object
      x-formgen-label-field: full_name
      properties:
        id:
          $ref: '#/components/schemas/UUID'
        full_name:
          type: string
    Manager:
      type: object
      x-formgen-label-field: name
      properties:
        id:
          $ref: '#/components/schemas/UUID'
        name:
          type: string
    Tag:
      type: object
      x-formgen-label-field: label
      properties:
        id:
          $ref: '#/components/schemas/UUID'
        label:
          type: string
    Category:
      type: object
      x-formgen-label-field: name
      properties:
        id:
          $ref: '#/components/schemas/UUID'
        name:
          type: string
    UUID:
      type: string
      format: uuid
